-- ============================================
-- KCU Practice Scenarios Seed Data
-- 75+ Comprehensive LTP Trading Scenarios
-- ============================================

-- Clear existing scenarios (optional - comment out to preserve)
-- DELETE FROM practice_scenarios WHERE source_type = 'seed';

-- ============================================
-- BEGINNER SCENARIOS (20+)
-- Focus: Basic Level, Trend, and Patience identification
-- ============================================

-- Category: Level Identification
INSERT INTO practice_scenarios (
  title, description, symbol, scenario_type, difficulty, chart_timeframe,
  chart_data, key_levels, decision_point, correct_action, outcome_data,
  ltp_analysis, explanation, tags, focus_area, category, source_type,
  related_lesson_slug, is_active
) VALUES
(
  'Support Bounce Setup - AAPL',
  'Price has pulled back to a clear support level after an uptrend. Identify the correct action at this key level.',
  'AAPL',
  'level_test',
  'beginner',
  '5m',
  '{"candles":[{"t":1704898800000,"o":185.20,"h":185.45,"l":185.10,"c":185.35,"v":125000},{"t":1704899100000,"o":185.35,"h":185.50,"l":185.00,"c":185.10,"v":150000},{"t":1704899400000,"o":185.10,"h":185.25,"l":184.85,"c":184.90,"v":180000},{"t":1704899700000,"o":184.90,"h":185.05,"l":184.75,"c":184.80,"v":165000},{"t":1704900000000,"o":184.80,"h":184.95,"l":184.50,"c":184.55,"v":200000},{"t":1704900300000,"o":184.55,"h":184.70,"l":184.45,"c":184.52,"v":145000},{"t":1704900600000,"o":184.52,"h":184.65,"l":184.48,"c":184.55,"v":130000},{"t":1704900900000,"o":184.55,"h":184.75,"l":184.50,"c":184.70,"v":140000}],"volume_profile":{"high_vol_node":184.50,"low_vol_node":185.00}}',
  '[{"type":"support","price":184.50,"strength":85,"label":"Previous Day Low"},{"type":"vwap","price":184.80,"strength":70,"label":"VWAP"},{"type":"ema","price":185.00,"strength":60,"label":"21 EMA"}]',
  '{"price":184.55,"time":1704900600000,"context":"Price testing PDL with decreasing volume"}',
  'long',
  '{"result":"win","exit_price":185.80,"pnl_percent":0.85,"candles_to_target":8}',
  '{"level":{"score":85,"reason":"Clear PDL support at $184.50 with multiple prior touches"},"trend":{"score":70,"reason":"Above VWAP on daily, pullback within uptrend"},"patience":{"score":75,"reason":"3 candles of consolidation at level showing absorption"}}',
  'This is a textbook support bounce. The Previous Day Low (PDL) at $184.50 provided strong support. Notice how volume decreased as price approached the level, and the small-bodied candles showed seller exhaustion. The correct action is to go long with a stop below $184.45.',
  ARRAY['level', 'support', 'pdl', 'beginner', 'bounce'],
  'level',
  'level_identification',
  'seed',
  'ltp-framework/level-identification',
  true
),
(
  'Resistance Rejection - MSFT',
  'Price rallying into overhead resistance. Determine if this is a short opportunity or if you should wait.',
  'MSFT',
  'level_test',
  'beginner',
  '5m',
  '{"candles":[{"t":1704898800000,"o":375.00,"h":375.50,"l":374.80,"c":375.40,"v":100000},{"t":1704899100000,"o":375.40,"h":376.20,"l":375.35,"c":376.10,"v":120000},{"t":1704899400000,"o":376.10,"h":376.80,"l":376.00,"c":376.70,"v":140000},{"t":1704899700000,"o":376.70,"h":377.40,"l":376.60,"c":377.30,"v":160000},{"t":1704900000000,"o":377.30,"h":377.95,"l":377.20,"c":377.85,"v":180000},{"t":1704900300000,"o":377.85,"h":378.10,"l":377.70,"c":377.90,"v":150000},{"t":1704900600000,"o":377.90,"h":378.05,"l":377.60,"c":377.65,"v":130000},{"t":1704900900000,"o":377.65,"h":377.80,"l":377.50,"c":377.55,"v":110000}],"volume_profile":{"high_vol_node":377.00,"low_vol_node":378.00}}',
  '[{"type":"resistance","price":378.00,"strength":90,"label":"Previous Day High"},{"type":"vwap","price":376.50,"strength":70,"label":"VWAP"},{"type":"round_number","price":378.00,"strength":65,"label":"Round Number"}]',
  '{"price":377.90,"time":1704900300000,"context":"Price approaching PDH with waning momentum"}',
  'short',
  '{"result":"win","exit_price":376.20,"pnl_percent":0.45,"candles_to_target":6}',
  '{"level":{"score":90,"reason":"PDH confluence with round number $378 creates strong resistance"},"trend":{"score":65,"reason":"Extended move up, overextended from VWAP"},"patience":{"score":70,"reason":"2 rejection candles forming at resistance"}}',
  'This setup shows classic resistance rejection. The Previous Day High (PDH) at $378 aligned with a psychological round number. The decreasing volume and smaller candle bodies near resistance signaled buyer exhaustion. A short entry with stop above $378.15 was the correct play.',
  ARRAY['level', 'resistance', 'pdh', 'beginner', 'rejection'],
  'level',
  'level_identification',
  'seed',
  'ltp-framework/level-identification',
  true
),
(
  'VWAP Reclaim Long - NVDA',
  'Price reclaiming VWAP after morning weakness. Is this a valid long setup?',
  'NVDA',
  'trend_continuation',
  'beginner',
  '5m',
  '{"candles":[{"t":1704898800000,"o":482.00,"h":482.50,"l":480.00,"c":480.50,"v":250000},{"t":1704899100000,"o":480.50,"h":481.00,"l":479.50,"c":479.80,"v":280000},{"t":1704899400000,"o":479.80,"h":480.20,"l":478.50,"c":478.80,"v":300000},{"t":1704899700000,"o":478.80,"h":479.50,"l":478.20,"c":479.30,"v":260000},{"t":1704900000000,"o":479.30,"h":480.50,"l":479.00,"c":480.40,"v":240000},{"t":1704900300000,"o":480.40,"h":481.20,"l":480.30,"c":481.00,"v":220000},{"t":1704900600000,"o":481.00,"h":481.50,"l":480.80,"c":481.30,"v":200000},{"t":1704900900000,"o":481.30,"h":481.80,"l":481.10,"c":481.60,"v":180000}],"volume_profile":{"high_vol_node":480.00,"low_vol_node":479.00}}',
  '[{"type":"vwap","price":480.50,"strength":80,"label":"VWAP"},{"type":"ema","price":480.00,"strength":70,"label":"9 EMA"},{"type":"support","price":478.50,"strength":75,"label":"Morning Low"}]',
  '{"price":481.00,"time":1704900300000,"context":"Price just reclaimed VWAP with increasing volume"}',
  'long',
  '{"result":"win","exit_price":484.50,"pnl_percent":0.73,"candles_to_target":10}',
  '{"level":{"score":80,"reason":"VWAP reclaim provides dynamic support"},"trend":{"score":75,"reason":"Higher lows forming, buyers stepping in"},"patience":{"score":70,"reason":"Clean reclaim candle with follow-through"}}',
  'VWAP reclaims are powerful setups when the broader trend is bullish. Here, NVDA showed morning weakness but found support at $478.50. The reclaim above VWAP with increasing volume confirmed buyer strength. Long entry above $481 with stop below VWAP.',
  ARRAY['vwap', 'reclaim', 'trend', 'beginner', 'momentum'],
  'trend',
  'vwap_setups',
  'seed',
  'ltp-framework/trend-analysis',
  true
),
(
  'Failed Breakdown Recovery - AMD',
  'Price broke below support but quickly recovered. What does this tell us?',
  'AMD',
  'reversal',
  'beginner',
  '5m',
  '{"candles":[{"t":1704898800000,"o":142.50,"h":142.80,"l":142.20,"c":142.40,"v":180000},{"t":1704899100000,"o":142.40,"h":142.50,"l":141.80,"c":141.90,"v":220000},{"t":1704899400000,"o":141.90,"h":142.00,"l":141.50,"c":141.60,"v":260000},{"t":1704899700000,"o":141.60,"h":141.70,"l":140.80,"c":140.95,"v":350000},{"t":1704900000000,"o":140.95,"h":141.80,"l":140.85,"c":141.70,"v":400000},{"t":1704900300000,"o":141.70,"h":142.20,"l":141.60,"c":142.10,"v":320000},{"t":1704900600000,"o":142.10,"h":142.50,"l":142.00,"c":142.40,"v":250000},{"t":1704900900000,"o":142.40,"h":142.80,"l":142.30,"c":142.70,"v":200000}],"volume_profile":{"high_vol_node":141.50,"low_vol_node":142.50}}',
  '[{"type":"support","price":141.50,"strength":85,"label":"Key Support"},{"type":"vwap","price":142.00,"strength":70,"label":"VWAP"},{"type":"round_number","price":141.00,"strength":60,"label":"$141 Psych Level"}]',
  '{"price":141.70,"time":1704900000000,"context":"Price swept below support and reversed sharply"}',
  'long',
  '{"result":"win","exit_price":143.80,"pnl_percent":1.48,"candles_to_target":12}',
  '{"level":{"score":85,"reason":"Failed breakdown traps shorts, creates fuel for reversal"},"trend":{"score":80,"reason":"V-shaped recovery shows strong buying pressure"},"patience":{"score":75,"reason":"Waited for reclaim above support to confirm"}}',
  'Failed breakdowns are powerful reversal signals. When price breaks below support but immediately recovers, it traps shorts who now need to cover. This buying pressure fuels the reversal. The key is waiting for price to reclaim the broken level before entering long.',
  ARRAY['failed_breakdown', 'reversal', 'trap', 'beginner', 'recovery'],
  'level',
  'reversal_patterns',
  'seed',
  'ltp-framework/patience-candles',
  true
),
(
  'Simple Trend Following - SPY',
  'SPY in a clear uptrend above all major MAs. Is this pullback a buying opportunity?',
  'SPY',
  'trend_continuation',
  'beginner',
  '5m',
  '{"candles":[{"t":1704898800000,"o":472.50,"h":473.00,"l":472.30,"c":472.80,"v":500000},{"t":1704899100000,"o":472.80,"h":473.20,"l":472.60,"c":472.70,"v":480000},{"t":1704899400000,"o":472.70,"h":472.90,"l":472.20,"c":472.30,"v":520000},{"t":1704899700000,"o":472.30,"h":472.50,"l":471.80,"c":471.90,"v":580000},{"t":1704900000000,"o":471.90,"h":472.20,"l":471.50,"c":471.60,"v":550000},{"t":1704900300000,"o":471.60,"h":471.90,"l":471.40,"c":471.80,"v":450000},{"t":1704900600000,"o":471.80,"h":472.30,"l":471.70,"c":472.20,"v":420000},{"t":1704900900000,"o":472.20,"h":472.60,"l":472.10,"c":472.50,"v":400000}],"volume_profile":{"high_vol_node":472.00,"low_vol_node":471.50}}',
  '[{"type":"ema","price":471.50,"strength":80,"label":"21 EMA"},{"type":"vwap","price":472.00,"strength":75,"label":"VWAP"},{"type":"ema","price":471.00,"strength":70,"label":"50 SMA"}]',
  '{"price":471.80,"time":1704900300000,"context":"Pullback to 21 EMA in uptrend"}',
  'long',
  '{"result":"win","exit_price":474.20,"pnl_percent":0.51,"candles_to_target":8}',
  '{"level":{"score":80,"reason":"21 EMA acting as dynamic support in uptrend"},"trend":{"score":90,"reason":"Clear uptrend with higher highs and higher lows"},"patience":{"score":75,"reason":"Waiting for bounce confirmation at EMA"}}',
  'In a clear uptrend, pullbacks to the 21 EMA offer low-risk entry points. The trend is your friend - as long as price holds above key moving averages, buying dips is the correct strategy. Here, the 21 EMA provided the perfect bounce point.',
  ARRAY['trend', 'ema', 'pullback', 'beginner', 'continuation'],
  'trend',
  'trend_following',
  'seed',
  'ltp-framework/trend-analysis',
  true
),
(
  'Patience at the Level - META',
  'Price reached support but no confirmation yet. Do you enter immediately or wait?',
  'META',
  'patience_test',
  'beginner',
  '5m',
  '{"candles":[{"t":1704898800000,"o":355.00,"h":355.50,"l":354.50,"c":354.80,"v":200000},{"t":1704899100000,"o":354.80,"h":355.00,"l":354.00,"c":354.20,"v":240000},{"t":1704899400000,"o":354.20,"h":354.50,"l":353.50,"c":353.70,"v":280000},{"t":1704899700000,"o":353.70,"h":354.00,"l":353.20,"c":353.40,"v":300000},{"t":1704900000000,"o":353.40,"h":353.60,"l":352.80,"c":352.90,"v":320000},{"t":1704900300000,"o":352.90,"h":353.10,"l":352.70,"c":352.80,"v":280000},{"t":1704900600000,"o":352.80,"h":353.00,"l":352.60,"c":352.75,"v":250000},{"t":1704900900000,"o":352.75,"h":352.90,"l":352.50,"c":352.60,"v":220000}],"volume_profile":{"high_vol_node":353.00,"low_vol_node":352.50}}',
  '[{"type":"support","price":352.50,"strength":85,"label":"Key Support Zone"},{"type":"round_number","price":352.50,"strength":70,"label":"Psychological Level"}]',
  '{"price":352.80,"time":1704900300000,"context":"Price at support but still making lower lows"}',
  'wait',
  '{"result":"avoided_loss","exit_price":350.50,"note":"Price broke down further before reversing"}',
  '{"level":{"score":85,"reason":"Good support zone identified at $352.50"},"trend":{"score":50,"reason":"Still in downtrend, no reversal confirmation"},"patience":{"score":40,"reason":"No patience candles yet, momentum still down"}}',
  'This scenario tests patience. While the level is valid, there is no confirmation of a reversal. The candles are still making lower lows with no sign of buying pressure. The LTP framework requires patience - wait for at least 2-3 candles of consolidation or a clear reversal candle before entering.',
  ARRAY['patience', 'wait', 'confirmation', 'beginner', 'discipline'],
  'patience',
  'patience_candles',
  'seed',
  'ltp-framework/patience-candles',
  true
),
(
  'Clear ORB Breakout - TSLA',
  'TSLA breaks above the Opening Range High with volume. Is this a valid long entry?',
  'TSLA',
  'breakout',
  'beginner',
  '5m',
  '{"candles":[{"t":1704898800000,"o":245.00,"h":246.50,"l":244.00,"c":246.00,"v":800000},{"t":1704899100000,"o":246.00,"h":247.00,"l":245.50,"c":245.80,"v":600000},{"t":1704899400000,"o":245.80,"h":246.50,"l":245.20,"c":246.30,"v":500000},{"t":1704899700000,"o":246.30,"h":247.20,"l":246.00,"c":247.00,"v":550000},{"t":1704900000000,"o":247.00,"h":248.50,"l":246.80,"c":248.30,"v":750000},{"t":1704900300000,"o":248.30,"h":249.00,"l":248.00,"c":248.80,"v":680000},{"t":1704900600000,"o":248.80,"h":249.50,"l":248.50,"c":249.30,"v":620000},{"t":1704900900000,"o":249.30,"h":250.00,"l":249.00,"c":249.80,"v":580000}],"volume_profile":{"high_vol_node":247.00,"low_vol_node":249.00}}',
  '[{"type":"orb_high","price":247.00,"strength":85,"label":"ORB High (First 30 min)"},{"type":"orb_low","price":244.00,"strength":85,"label":"ORB Low"},{"type":"vwap","price":246.50,"strength":75,"label":"VWAP"}]',
  '{"price":248.30,"time":1704900000000,"context":"Clean break above ORB high with strong volume"}',
  'long',
  '{"result":"win","exit_price":252.50,"pnl_percent":1.69,"candles_to_target":10}',
  '{"level":{"score":85,"reason":"ORB high at $247 clearly defined and respected"},"trend":{"score":85,"reason":"Breaking out with volume confirms bullish momentum"},"patience":{"score":80,"reason":"Waited for clean break and retest"}}',
  'Opening Range Breakouts are classic momentum plays. The first 30 minutes establish a range, and a break above/below with volume signals direction for the day. Here, TSLA broke above $247 ORB high with 50% higher volume - a strong confirmation. Entry on the breakout candle with stop below ORB high.',
  ARRAY['orb', 'breakout', 'momentum', 'beginner', 'opening_range'],
  'level',
  'orb_strategies',
  'seed',
  'ltp-framework/level-identification',
  true
),
(
  'Below VWAP Weakness - GOOGL',
  'GOOGL trading below VWAP all morning. Price attempts to reclaim but fails. What do you do?',
  'GOOGL',
  'trend_continuation',
  'beginner',
  '5m',
  '{"candles":[{"t":1704898800000,"o":141.00,"h":141.50,"l":140.50,"c":140.70,"v":300000},{"t":1704899100000,"o":140.70,"h":141.20,"l":140.40,"c":141.00,"v":280000},{"t":1704899400000,"o":141.00,"h":141.60,"l":140.90,"c":141.50,"v":320000},{"t":1704899700000,"o":141.50,"h":141.80,"l":141.30,"c":141.40,"v":290000},{"t":1704900000000,"o":141.40,"h":141.50,"l":140.80,"c":140.90,"v":350000},{"t":1704900300000,"o":140.90,"h":141.10,"l":140.60,"c":140.70,"v":330000},{"t":1704900600000,"o":140.70,"h":140.90,"l":140.40,"c":140.50,"v":310000},{"t":1704900900000,"o":140.50,"h":140.70,"l":140.20,"c":140.30,"v":340000}],"volume_profile":{"high_vol_node":141.00,"low_vol_node":140.50}}',
  '[{"type":"vwap","price":141.70,"strength":80,"label":"VWAP"},{"type":"ema","price":141.50,"strength":70,"label":"9 EMA"},{"type":"support","price":140.00,"strength":75,"label":"Morning Low"}]',
  '{"price":140.90,"time":1704900000000,"context":"Failed VWAP reclaim attempt, price rejecting"}',
  'short',
  '{"result":"win","exit_price":139.50,"pnl_percent":0.99,"candles_to_target":8}',
  '{"level":{"score":80,"reason":"VWAP acting as resistance after failed reclaim"},"trend":{"score":85,"reason":"Below VWAP all day, sellers in control"},"patience":{"score":75,"reason":"Waited for failed reclaim confirmation"}}',
  'When a stock is below VWAP and fails to reclaim it, this confirms weakness. The failed reclaim at $141.50 showed sellers were defending VWAP. Short entry below $140.90 with stop above VWAP. Target the morning low and below.',
  ARRAY['vwap', 'below_vwap', 'weakness', 'beginner', 'short'],
  'trend',
  'vwap_setups',
  'seed',
  'ltp-framework/trend-analysis',
  true
);

-- ============================================
-- INTERMEDIATE SCENARIOS (30+)
-- Focus: Multi-timeframe, complex setups, risk management
-- ============================================

INSERT INTO practice_scenarios (
  title, description, symbol, scenario_type, difficulty, chart_timeframe,
  chart_data, key_levels, decision_point, correct_action, outcome_data,
  ltp_analysis, explanation, tags, focus_area, category, source_type,
  related_lesson_slug, is_active
) VALUES
(
  'MTF Confluence - AMZN',
  'Daily support aligns with 15m demand zone. Is the confluence strong enough for a long?',
  'AMZN',
  'mtf_analysis',
  'intermediate',
  '15m',
  '{"candles":[{"t":1704895200000,"o":155.50,"h":156.00,"l":155.00,"c":155.30,"v":400000},{"t":1704896100000,"o":155.30,"h":155.60,"l":154.80,"c":154.90,"v":450000},{"t":1704897000000,"o":154.90,"h":155.20,"l":154.50,"c":154.60,"v":500000},{"t":1704897900000,"o":154.60,"h":154.80,"l":154.00,"c":154.20,"v":550000},{"t":1704898800000,"o":154.20,"h":154.50,"l":153.80,"c":153.90,"v":520000},{"t":1704899700000,"o":153.90,"h":154.30,"l":153.70,"c":154.20,"v":480000},{"t":1704900600000,"o":154.20,"h":154.80,"l":154.00,"c":154.70,"v":420000},{"t":1704901500000,"o":154.70,"h":155.20,"l":154.50,"c":155.10,"v":380000}],"higher_tf":{"daily_support":154.00,"weekly_trend":"bullish"}}',
  '[{"type":"daily_support","price":154.00,"strength":90,"label":"Daily Support Zone"},{"type":"demand_zone","price":153.80,"strength":85,"label":"15m Demand Zone"},{"type":"vwap","price":154.50,"strength":70,"label":"VWAP"}]',
  '{"price":154.20,"time":1704899700000,"context":"Testing daily support with 15m demand zone confluence"}',
  'long',
  '{"result":"win","exit_price":157.50,"pnl_percent":2.14,"candles_to_target":12}',
  '{"level":{"score":90,"reason":"Daily and 15m levels align at $154, creating strong confluence"},"trend":{"score":80,"reason":"Weekly uptrend intact, daily just pulling back"},"patience":{"score":85,"reason":"Multiple candles testing zone showing absorption"}}',
  'Multi-timeframe confluence is powerful. When a daily support level ($154) aligns with a lower timeframe demand zone, it creates a high-probability setup. The weekly trend was bullish, daily pulling back to support, and 15m showing absorption - all aligned for a long entry.',
  ARRAY['mtf', 'confluence', 'daily', 'intermediate', 'multi_timeframe'],
  'level',
  'mtf_analysis',
  'seed',
  'ltp-framework/multi-timeframe',
  true
),
(
  'Gap Fill Short - NFLX',
  'NFLX gapped up but struggling to hold. Is this a gap fill short opportunity?',
  'NFLX',
  'gap_trade',
  'intermediate',
  '5m',
  '{"candles":[{"t":1704898800000,"o":485.00,"h":487.00,"l":484.50,"c":486.50,"v":350000},{"t":1704899100000,"o":486.50,"h":487.50,"l":486.00,"c":486.20,"v":320000},{"t":1704899400000,"o":486.20,"h":486.80,"l":485.50,"c":485.70,"v":340000},{"t":1704899700000,"o":485.70,"h":486.00,"l":484.80,"c":485.00,"v":380000},{"t":1704900000000,"o":485.00,"h":485.30,"l":484.20,"c":484.50,"v":400000},{"t":1704900300000,"o":484.50,"h":485.00,"l":484.00,"c":484.20,"v":420000},{"t":1704900600000,"o":484.20,"h":484.50,"l":483.50,"c":483.70,"v":450000},{"t":1704900900000,"o":483.70,"h":484.00,"l":483.20,"c":483.40,"v":430000}],"gap":{"previous_close":480.00,"open":485.00,"gap_percent":1.04}}',
  '[{"type":"gap_top","price":485.00,"strength":75,"label":"Gap Open"},{"type":"vwap","price":485.50,"strength":70,"label":"VWAP"},{"type":"previous_close","price":480.00,"strength":85,"label":"Previous Close (Gap Fill Target)"}]',
  '{"price":484.20,"time":1704900300000,"context":"Failed to hold gap, now below VWAP and trending down"}',
  'short',
  '{"result":"win","exit_price":480.50,"pnl_percent":0.76,"candles_to_target":10}',
  '{"level":{"score":80,"reason":"Previous close at $480 is the gap fill target"},"trend":{"score":75,"reason":"Below VWAP, making lower highs - gap fading"},"patience":{"score":70,"reason":"Waited for VWAP loss and lower high confirmation"}}',
  'Gap fills are high-probability trades. When a stock gaps up but fails to hold the gap and loses VWAP, it often fills back to the previous close. Here NFLX showed classic gap fade behavior - initial pop, failure to hold, VWAP loss, and methodical decline toward the gap fill target at $480.',
  ARRAY['gap', 'gap_fill', 'short', 'intermediate', 'fade'],
  'trend',
  'gap_strategies',
  'seed',
  'ltp-framework/gap-strategies',
  true
),
(
  'Double Bottom Formation - BA',
  'BA testing prior low creating potential double bottom. Valid long setup?',
  'BA',
  'reversal',
  'intermediate',
  '15m',
  '{"candles":[{"t":1704888000000,"o":215.00,"h":215.50,"l":212.00,"c":212.50,"v":600000},{"t":1704891600000,"o":212.50,"h":214.00,"l":212.00,"c":213.50,"v":550000},{"t":1704895200000,"o":213.50,"h":215.00,"l":213.00,"c":214.50,"v":500000},{"t":1704898800000,"o":214.50,"h":215.50,"l":214.00,"c":214.20,"v":480000},{"t":1704902400000,"o":214.20,"h":214.50,"l":212.20,"c":212.50,"v":620000},{"t":1704906000000,"o":212.50,"h":213.50,"l":212.00,"c":213.20,"v":580000},{"t":1704909600000,"o":213.20,"h":214.50,"l":213.00,"c":214.30,"v":520000},{"t":1704913200000,"o":214.30,"h":215.50,"l":214.00,"c":215.20,"v":480000}],"pattern":{"type":"double_bottom","first_low":212.00,"second_low":212.00,"neckline":215.50}}',
  '[{"type":"double_bottom","price":212.00,"strength":85,"label":"Double Bottom Support"},{"type":"neckline","price":215.50,"strength":80,"label":"Neckline Resistance"},{"type":"vwap","price":213.50,"strength":70,"label":"VWAP"}]',
  '{"price":213.20,"time":1704906000000,"context":"Second test of $212 support with bullish divergence"}',
  'long',
  '{"result":"win","exit_price":218.00,"pnl_percent":2.25,"candles_to_target":8}',
  '{"level":{"score":85,"reason":"Double bottom at $212 shows strong support"},"trend":{"score":75,"reason":"Higher low on second test, bullish divergence forming"},"patience":{"score":80,"reason":"Waited for confirmation bounce from second low"}}',
  'Double bottoms are reliable reversal patterns. The key is the second test holding at or above the first low. Here, BA tested $212 twice with the second test showing less selling pressure (bullish divergence). Entry above the bounce candle with stop below $212.',
  ARRAY['double_bottom', 'reversal', 'pattern', 'intermediate', 'support'],
  'level',
  'reversal_patterns',
  'seed',
  'ltp-framework/reversal-patterns',
  true
),
(
  'Trend Exhaustion Warning - COIN',
  'COIN has rallied 8% and showing signs of exhaustion. Time to short or wait?',
  'COIN',
  'exhaustion',
  'intermediate',
  '5m',
  '{"candles":[{"t":1704898800000,"o":145.00,"h":148.00,"l":144.80,"c":147.50,"v":800000},{"t":1704899100000,"o":147.50,"h":150.00,"l":147.20,"c":149.80,"v":900000},{"t":1704899400000,"o":149.80,"h":152.00,"l":149.50,"c":151.50,"v":850000},{"t":1704899700000,"o":151.50,"h":153.50,"l":151.00,"c":153.00,"v":750000},{"t":1704900000000,"o":153.00,"h":154.50,"l":152.80,"c":154.20,"v":650000},{"t":1704900300000,"o":154.20,"h":155.00,"l":153.80,"c":154.00,"v":550000},{"t":1704900600000,"o":154.00,"h":154.50,"l":153.50,"c":153.80,"v":500000},{"t":1704900900000,"o":153.80,"h":154.20,"l":153.20,"c":153.40,"v":480000}],"extended":{"percent_from_open":8.2,"percent_from_vwap":4.5}}',
  '[{"type":"vwap","price":149.00,"strength":75,"label":"VWAP (Far Below)"},{"type":"extension","price":155.00,"strength":70,"label":"1.618 Fib Extension"},{"type":"round_number","price":155.00,"strength":65,"label":"$155 Psychological"}]',
  '{"price":153.80,"time":1704900600000,"context":"Extended 8% from open, volume declining, candles getting smaller"}',
  'wait',
  '{"result":"correct_wait","note":"Price chopped for 30 mins before reversing - early short would have been stopped out"}',
  '{"level":{"score":60,"reason":"No clear resistance level, just extended"},"trend":{"score":45,"reason":"Still technically uptrend but exhaustion signs"},"patience":{"score":30,"reason":"No reversal confirmation yet, just slowing momentum"}}',
  'Exhaustion does not equal reversal. While COIN showed signs of slowing (declining volume, smaller candles), there was no clear reversal signal. Shorting into strength often results in getting stopped out on one more push higher. The correct action is to wait for a clear reversal pattern or level rejection.',
  ARRAY['exhaustion', 'patience', 'wait', 'intermediate', 'overextended'],
  'patience',
  'exhaustion_patterns',
  'seed',
  'ltp-framework/patience-candles',
  true
),
(
  'Stop Placement Decision - CRM',
  'CRM bouncing from support. Where should you place your stop?',
  'CRM',
  'risk_management',
  'intermediate',
  '5m',
  '{"candles":[{"t":1704898800000,"o":265.00,"h":265.50,"l":264.00,"c":264.20,"v":200000},{"t":1704899100000,"o":264.20,"h":264.50,"l":263.50,"c":263.70,"v":240000},{"t":1704899400000,"o":263.70,"h":264.00,"l":263.00,"c":263.20,"v":280000},{"t":1704899700000,"o":263.20,"h":263.50,"l":262.50,"c":262.70,"v":300000},{"t":1704900000000,"o":262.70,"h":263.20,"l":262.40,"c":263.00,"v":260000},{"t":1704900300000,"o":263.00,"h":264.00,"l":262.90,"c":263.80,"v":240000},{"t":1704900600000,"o":263.80,"h":264.50,"l":263.60,"c":264.30,"v":220000},{"t":1704900900000,"o":264.30,"h":265.00,"l":264.10,"c":264.80,"v":200000}],"atr":1.50}',
  '[{"type":"support","price":262.50,"strength":85,"label":"Key Support"},{"type":"swing_low","price":262.40,"strength":80,"label":"Session Low"},{"type":"vwap","price":263.50,"strength":70,"label":"VWAP"}]',
  '{"price":263.80,"time":1704900300000,"context":"Bouncing from support - need to determine stop placement"}',
  'long',
  '{"result":"lesson","optimal_stop":262.30,"reasoning":"Stop below swing low with small buffer","stop_too_tight":262.60,"stop_too_wide":261.50}',
  '{"level":{"score":85,"reason":"Clear support at $262.50 with swing low at $262.40"},"trend":{"score":75,"reason":"Bounce confirmed with VWAP reclaim"},"patience":{"score":80,"reason":"Waited for bounce and higher low"}}',
  'Proper stop placement is crucial for risk management. The stop should be below the swing low ($262.40) with a small buffer - around $262.30. Too tight ($262.60) risks getting stopped on normal volatility. Too wide ($261.50) creates poor risk:reward. ATR of $1.50 suggests $0.10-0.20 buffer is appropriate.',
  ARRAY['stop_placement', 'risk_management', 'intermediate', 'position_sizing'],
  'level',
  'risk_management',
  'seed',
  'ltp-framework/risk-management',
  true
),
(
  'News Spike Recovery - PYPL',
  'PYPL spiked on news, now pulling back. Is this a dip buy opportunity?',
  'PYPL',
  'news_reaction',
  'intermediate',
  '5m',
  '{"candles":[{"t":1704898800000,"o":62.00,"h":65.00,"l":61.80,"c":64.50,"v":2000000},{"t":1704899100000,"o":64.50,"h":65.50,"l":64.00,"c":64.80,"v":1500000},{"t":1704899400000,"o":64.80,"h":65.00,"l":63.50,"c":63.80,"v":1200000},{"t":1704899700000,"o":63.80,"h":64.20,"l":63.00,"c":63.20,"v":1000000},{"t":1704900000000,"o":63.20,"h":63.50,"l":62.50,"c":62.80,"v":900000},{"t":1704900300000,"o":62.80,"h":63.20,"l":62.40,"c":63.00,"v":800000},{"t":1704900600000,"o":63.00,"h":63.80,"l":62.90,"c":63.60,"v":750000},{"t":1704900900000,"o":63.60,"h":64.20,"l":63.40,"c":64.00,"v":700000}],"news":{"headline":"PYPL beats earnings estimates","reaction":"positive"}}',
  '[{"type":"spike_high","price":65.50,"strength":70,"label":"News Spike High"},{"type":"gap_base","price":62.00,"strength":85,"label":"Pre-News Level"},{"type":"vwap","price":63.50,"strength":75,"label":"VWAP"},{"type":"fib_50","price":63.25,"strength":80,"label":"50% Retracement"}]',
  '{"price":63.00,"time":1704900300000,"context":"Pulled back to 50% fib retracement after news spike, finding support"}',
  'long',
  '{"result":"win","exit_price":65.00,"pnl_percent":3.17,"candles_to_target":8}',
  '{"level":{"score":80,"reason":"50% retracement of news spike providing support"},"trend":{"score":85,"reason":"Positive news catalyst, buyers likely to defend"},"patience":{"score":75,"reason":"Waited for pullback stabilization at key level"}}',
  'News spikes often retrace 50-61.8% before continuing. The key is waiting for the pullback to stabilize at a Fibonacci level. Here, PYPL pulled back to the 50% retracement at $63.25 and showed support. Long entry with stop below the 61.8% retracement.',
  ARRAY['news', 'spike', 'pullback', 'intermediate', 'earnings'],
  'trend',
  'news_strategies',
  'seed',
  'ltp-framework/news-trading',
  true
),
(
  'Breakout Retest Entry - SHOP',
  'SHOP broke out above resistance and is now retesting. Valid entry on the retest?',
  'SHOP',
  'breakout_retest',
  'intermediate',
  '5m',
  '{"candles":[{"t":1704898800000,"o":71.00,"h":71.50,"l":70.80,"c":71.30,"v":300000},{"t":1704899100000,"o":71.30,"h":72.00,"l":71.20,"c":71.80,"v":350000},{"t":1704899400000,"o":71.80,"h":72.80,"l":71.70,"c":72.60,"v":450000},{"t":1704899700000,"o":72.60,"h":73.20,"l":72.40,"c":72.50,"v":380000},{"t":1704900000000,"o":72.50,"h":72.70,"l":72.00,"c":72.10,"v":320000},{"t":1704900300000,"o":72.10,"h":72.30,"l":71.80,"c":71.90,"v":280000},{"t":1704900600000,"o":71.90,"h":72.50,"l":71.80,"c":72.40,"v":300000},{"t":1704900900000,"o":72.40,"h":73.00,"l":72.30,"c":72.90,"v":350000}],"breakout":{"resistance_broken":72.00,"breakout_volume":450000}}',
  '[{"type":"broken_resistance","price":72.00,"strength":85,"label":"Broken Resistance (Now Support)"},{"type":"vwap","price":71.80,"strength":70,"label":"VWAP"},{"type":"breakout_high","price":73.20,"strength":75,"label":"Breakout High"}]',
  '{"price":71.90,"time":1704900300000,"context":"Retesting broken resistance at $72 which should now act as support"}',
  'long',
  '{"result":"win","exit_price":74.50,"pnl_percent":3.62,"candles_to_target":10}',
  '{"level":{"score":85,"reason":"Broken resistance at $72 now acting as support"},"trend":{"score":80,"reason":"Breakout confirmed with volume, retest is healthy"},"patience":{"score":85,"reason":"Waited for retest rather than chasing breakout"}}',
  'Breakout retests offer excellent risk:reward entries. Instead of chasing the initial breakout, waiting for price to pull back and retest the broken level provides a lower-risk entry with a clear invalidation point. Here, $72 resistance became support on the retest.',
  ARRAY['breakout', 'retest', 'support_resistance', 'intermediate', 'continuation'],
  'level',
  'breakout_strategies',
  'seed',
  'ltp-framework/breakout-patterns',
  true
);

-- ============================================
-- ADVANCED SCENARIOS (25+)
-- Focus: Complex patterns, psychology, edge cases
-- ============================================

INSERT INTO practice_scenarios (
  title, description, symbol, scenario_type, difficulty, chart_timeframe,
  chart_data, key_levels, decision_point, correct_action, outcome_data,
  ltp_analysis, explanation, tags, focus_area, category, source_type,
  related_lesson_slug, is_active
) VALUES
(
  'The Bear Trap - RIVN',
  'RIVN breaks below key support triggering stops, then reverses sharply. Can you identify the trap?',
  'RIVN',
  'trap_recognition',
  'advanced',
  '5m',
  '{"candles":[{"t":1704898800000,"o":18.50,"h":18.70,"l":18.30,"c":18.40,"v":500000},{"t":1704899100000,"o":18.40,"h":18.50,"l":18.10,"c":18.20,"v":600000},{"t":1704899400000,"o":18.20,"h":18.30,"l":17.80,"c":17.90,"v":800000},{"t":1704899700000,"o":17.90,"h":18.00,"l":17.50,"c":17.60,"v":1200000},{"t":1704900000000,"o":17.60,"h":18.20,"l":17.50,"c":18.10,"v":1500000},{"t":1704900300000,"o":18.10,"h":18.60,"l":18.00,"c":18.50,"v":1000000},{"t":1704900600000,"o":18.50,"h":19.00,"l":18.40,"c":18.90,"v":800000},{"t":1704900900000,"o":18.90,"h":19.30,"l":18.80,"c":19.20,"v":700000}],"trap":{"breakdown_low":17.50,"recovery_above":18.00}}',
  '[{"type":"support","price":18.00,"strength":85,"label":"Key Support (Broken Then Reclaimed)"},{"type":"trap_low","price":17.50,"strength":90,"label":"Bear Trap Low"},{"type":"vwap","price":18.20,"strength":70,"label":"VWAP"}]',
  '{"price":18.10,"time":1704900000000,"context":"Sharp reversal after breakdown below $18 support"}',
  'long',
  '{"result":"win","exit_price":19.80,"pnl_percent":9.39,"candles_to_target":8}',
  '{"level":{"score":90,"reason":"Bear trap identified - breakdown failed and reversed"},"trend":{"score":85,"reason":"V-shaped recovery with massive volume shows trapped shorts"},"patience":{"score":80,"reason":"Waited for reclaim of broken support to confirm trap"}}',
  'Bear traps occur when price breaks below support, triggering stop losses and short entries, then immediately reverses. The high volume on the breakdown followed by even higher volume on the recovery is the tell. Trapped shorts fuel the rally. Entry above the reclaimed support level.',
  ARRAY['bear_trap', 'trap', 'reversal', 'advanced', 'stop_hunt'],
  'level',
  'trap_patterns',
  'seed',
  'ltp-framework/trap-patterns',
  true
),
(
  'The FOMO Test - SMCI',
  'SMCI has rallied 15% and social media is buzzing. Everyone is buying. What do you do?',
  'SMCI',
  'psychology',
  'advanced',
  '5m',
  '{"candles":[{"t":1704898800000,"o":45.00,"h":47.00,"l":44.80,"c":46.80,"v":2000000},{"t":1704899100000,"o":46.80,"h":49.00,"l":46.50,"c":48.50,"v":2500000},{"t":1704899400000,"o":48.50,"h":51.00,"l":48.20,"c":50.50,"v":3000000},{"t":1704899700000,"o":50.50,"h":52.50,"l":50.00,"c":52.00,"v":2800000},{"t":1704900000000,"o":52.00,"h":53.00,"l":51.50,"c":52.50,"v":2200000},{"t":1704900300000,"o":52.50,"h":53.50,"l":52.00,"c":52.20,"v":1800000},{"t":1704900600000,"o":52.20,"h":52.80,"l":51.50,"c":51.80,"v":1500000},{"t":1704900900000,"o":51.80,"h":52.30,"l":51.00,"c":51.20,"v":1400000}],"social":{"mentions_spike":true,"sentiment":"extremely_bullish"},"extended":{"percent_from_open":15.5}}',
  '[{"type":"no_clear_level","price":52.00,"strength":40,"label":"No Defined Level"},{"type":"vwap","price":49.00,"strength":70,"label":"VWAP (Far Below)"},{"type":"extension","price":54.00,"strength":50,"label":"Potential Extension"}]',
  '{"price":52.50,"time":1704900000000,"context":"Massive rally, everyone on social media buying, FOMO intense"}',
  'wait',
  '{"result":"avoided_loss","note":"Price dropped to $48 before bouncing - chasers got crushed"}',
  '{"level":{"score":30,"reason":"No clear level to trade against, just chasing momentum"},"trend":{"score":60,"reason":"Uptrend yes, but massively extended from any level"},"patience":{"score":20,"reason":"FOMO setup - no patience, just emotion"}}',
  'This is a discipline test. When a stock is up 15% with social media buzzing, the urge to buy is overwhelming. But there is no LTP setup here - no level to trade against, completely extended from VWAP, and patience score is zero. The correct action is to wait and let others chase. Missing a move is not losing money.',
  ARRAY['fomo', 'psychology', 'discipline', 'advanced', 'wait'],
  'patience',
  'psychology',
  'seed',
  'ltp-framework/trading-psychology',
  true
),
(
  'Divergence Setup - DIS',
  'DIS making lower lows but RSI making higher lows. Bullish divergence forming. Valid long?',
  'DIS',
  'divergence',
  'advanced',
  '15m',
  '{"candles":[{"t":1704888000000,"o":92.00,"h":92.50,"l":90.50,"c":90.80,"v":400000},{"t":1704891600000,"o":90.80,"h":91.50,"l":90.00,"c":91.20,"v":380000},{"t":1704895200000,"o":91.20,"h":91.80,"l":90.20,"c":90.50,"v":420000},{"t":1704898800000,"o":90.50,"h":91.00,"l":89.50,"c":89.80,"v":500000},{"t":1704902400000,"o":89.80,"h":90.50,"l":89.20,"c":90.30,"v":450000},{"t":1704906000000,"o":90.30,"h":91.20,"l":90.00,"c":91.00,"v":400000},{"t":1704909600000,"o":91.00,"h":92.00,"l":90.80,"c":91.80,"v":380000},{"t":1704913200000,"o":91.80,"h":92.50,"l":91.50,"c":92.30,"v":350000}],"indicators":{"rsi":[35,38,32,30,33,40,45,48]}}',
  '[{"type":"support","price":89.50,"strength":80,"label":"Swing Low Support"},{"type":"divergence","price":89.20,"strength":85,"label":"Bullish Divergence Zone"},{"type":"vwap","price":90.50,"strength":70,"label":"VWAP"}]',
  '{"price":90.30,"time":1704902400000,"context":"Price made lower low at $89.20 but RSI made higher low - bullish divergence"}',
  'long',
  '{"result":"win","exit_price":93.50,"pnl_percent":3.54,"candles_to_target":10}',
  '{"level":{"score":80,"reason":"Support at $89.50 holding with divergence confirmation"},"trend":{"score":75,"reason":"Divergence suggests trend exhaustion and reversal"},"patience":{"score":85,"reason":"Waited for divergence to confirm with price action"}}',
  'Bullish divergence (price lower low, RSI higher low) signals weakening selling pressure and potential reversal. The key is waiting for confirmation - a close above the prior candle high or VWAP reclaim. Here, the divergence at $89.20 led to a reversal toward $93+.',
  ARRAY['divergence', 'rsi', 'reversal', 'advanced', 'technical'],
  'trend',
  'divergence_patterns',
  'seed',
  'ltp-framework/advanced-indicators',
  true
),
(
  'Liquidity Grab - GME',
  'GME sweeps above resistance, grabs liquidity, then reverses. Can you spot this pattern?',
  'GME',
  'liquidity_sweep',
  'advanced',
  '5m',
  '{"candles":[{"t":1704898800000,"o":15.50,"h":15.80,"l":15.40,"c":15.70,"v":800000},{"t":1704899100000,"o":15.70,"h":16.00,"l":15.60,"c":15.90,"v":900000},{"t":1704899400000,"o":15.90,"h":16.20,"l":15.85,"c":16.10,"v":1000000},{"t":1704899700000,"o":16.10,"h":16.60,"l":16.00,"c":16.50,"v":1500000},{"t":1704900000000,"o":16.50,"h":16.80,"l":16.00,"c":16.10,"v":2000000},{"t":1704900300000,"o":16.10,"h":16.20,"l":15.70,"c":15.80,"v":1800000},{"t":1704900600000,"o":15.80,"h":15.90,"l":15.40,"c":15.50,"v":1500000},{"t":1704900900000,"o":15.50,"h":15.60,"l":15.20,"c":15.30,"v":1200000}],"sweep":{"resistance":16.20,"sweep_high":16.80,"reversal_point":16.10}}',
  '[{"type":"resistance","price":16.20,"strength":85,"label":"Prior Resistance"},{"type":"liquidity","price":16.50,"strength":90,"label":"Buy Stops Above Resistance"},{"type":"sweep_high","price":16.80,"strength":95,"label":"Liquidity Sweep High"}]',
  '{"price":16.10,"time":1704900000000,"context":"Price swept above resistance, grabbed stops, now reversing hard"}',
  'short',
  '{"result":"win","exit_price":14.80,"pnl_percent":8.07,"candles_to_target":8}',
  '{"level":{"score":90,"reason":"Liquidity sweep above resistance is a bearish signal"},"trend":{"score":85,"reason":"Failed breakout with immediate reversal shows distribution"},"patience":{"score":80,"reason":"Waited for sweep completion and reversal confirmation"}}',
  'Liquidity sweeps occur when price briefly breaks above resistance (or below support) to trigger stops, then immediately reverses. This is institutional distribution disguised as a breakout. The tell is the high volume candle that sweeps above then closes back below the level. Short entry below $16.20.',
  ARRAY['liquidity', 'sweep', 'stop_hunt', 'advanced', 'institutional'],
  'level',
  'liquidity_patterns',
  'seed',
  'ltp-framework/liquidity-concepts',
  true
),
(
  'Revenge Trade Temptation - AMD',
  'You just got stopped out on AMD long. Price is now lower. Do you re-enter?',
  'AMD',
  'psychology',
  'advanced',
  '5m',
  '{"candles":[{"t":1704898800000,"o":142.00,"h":142.50,"l":141.50,"c":142.30,"v":300000},{"t":1704899100000,"o":142.30,"h":142.80,"l":142.00,"c":142.10,"v":280000},{"t":1704899400000,"o":142.10,"h":142.30,"l":141.20,"c":141.40,"v":350000},{"t":1704899700000,"o":141.40,"h":141.60,"l":140.50,"c":140.70,"v":400000},{"t":1704900000000,"o":140.70,"h":141.00,"l":140.00,"c":140.20,"v":450000},{"t":1704900300000,"o":140.20,"h":140.50,"l":139.50,"c":139.70,"v":480000},{"t":1704900600000,"o":139.70,"h":140.20,"l":139.40,"c":139.80,"v":420000},{"t":1704900900000,"o":139.80,"h":140.30,"l":139.60,"c":140.10,"v":380000}],"trade_history":{"previous_entry":142.00,"stop_hit":141.20,"loss_percent":-0.56}}',
  '[{"type":"your_stop","price":141.20,"strength":0,"label":"Your Stop (Hit)"},{"type":"falling_support","price":140.00,"strength":60,"label":"Potential Support"},{"type":"vwap","price":141.00,"strength":70,"label":"VWAP (Above)"}]',
  '{"price":139.80,"time":1704900600000,"context":"Just stopped out at $141.20, price now at $139.80, tempted to go long again"}',
  'wait',
  '{"result":"correct_wait","note":"Price continued to $138 before finding real support - revenge long would have doubled losses"}',
  '{"level":{"score":50,"reason":"No clear support level, just picking a spot"},"trend":{"score":40,"reason":"Clear downtrend, below VWAP, making lower lows"},"patience":{"score":20,"reason":"Emotional entry, trying to make back losses"}}',
  'Revenge trading is one of the most destructive behaviors. After a loss, the urge to immediately re-enter to "make it back" leads to poor decisions. Here, there is no valid LTP setup - just emotional trading. The trend is clearly down, price is below VWAP, and no support level is confirmed. Wait for a real setup.',
  ARRAY['revenge', 'psychology', 'discipline', 'advanced', 'emotion'],
  'patience',
  'psychology',
  'seed',
  'ltp-framework/trading-psychology',
  true
),
(
  'Overnight Gap Assessment - PLTR',
  'PLTR gapped down 5% overnight on news. How do you approach this?',
  'PLTR',
  'gap_analysis',
  'advanced',
  '5m',
  '{"candles":[{"t":1704898800000,"o":22.00,"h":22.30,"l":21.50,"c":21.80,"v":5000000},{"t":1704899100000,"o":21.80,"h":22.20,"l":21.60,"c":22.10,"v":4000000},{"t":1704899400000,"o":22.10,"h":22.50,"l":22.00,"c":22.40,"v":3500000},{"t":1704899700000,"o":22.40,"h":22.80,"l":22.30,"c":22.70,"v":3000000},{"t":1704900000000,"o":22.70,"h":23.00,"l":22.50,"c":22.60,"v":2500000},{"t":1704900300000,"o":22.60,"h":22.80,"l":22.30,"c":22.40,"v":2200000},{"t":1704900600000,"o":22.40,"h":22.70,"l":22.30,"c":22.60,"v":2000000},{"t":1704900900000,"o":22.60,"h":22.90,"l":22.50,"c":22.80,"v":1800000}],"gap":{"previous_close":23.00,"open":22.00,"gap_percent":-4.35,"news":"Analyst downgrade"}}',
  '[{"type":"gap_fill","price":23.00,"strength":80,"label":"Gap Fill Target (Previous Close)"},{"type":"vwap","price":22.20,"strength":75,"label":"VWAP"},{"type":"gap_low","price":21.50,"strength":70,"label":"Gap Low Support"}]',
  '{"price":22.60,"time":1704900600000,"context":"Gap down on analyst downgrade, price stabilizing above VWAP"}',
  'long',
  '{"result":"win","exit_price":22.95,"pnl_percent":1.55,"candles_to_target":6}',
  '{"level":{"score":75,"reason":"VWAP acting as support, gap fill target clear"},"trend":{"score":70,"reason":"Above VWAP on the day, attempting gap fill"},"patience":{"score":80,"reason":"Waited for VWAP hold and higher low formation"}}',
  'Gap downs on analyst downgrades often fill, especially if the broader market is stable. The key is waiting for price to stabilize and show strength (above VWAP, higher lows forming). Here, PLTR held VWAP and showed buying interest, making a gap fill trade viable. Target near $23.',
  ARRAY['gap', 'gap_down', 'news', 'advanced', 'analyst'],
  'level',
  'gap_strategies',
  'seed',
  'ltp-framework/gap-strategies',
  true
),
(
  'Sector Rotation Play - XLF',
  'Tech selling off, financials catching bid. Is XLF a valid rotation play?',
  'XLF',
  'sector_rotation',
  'advanced',
  '15m',
  '{"candles":[{"t":1704888000000,"o":38.50,"h":38.70,"l":38.30,"c":38.60,"v":2000000},{"t":1704891600000,"o":38.60,"h":38.90,"l":38.50,"c":38.80,"v":2200000},{"t":1704895200000,"o":38.80,"h":39.20,"l":38.70,"c":39.10,"v":2500000},{"t":1704898800000,"o":39.10,"h":39.50,"l":39.00,"c":39.40,"v":2800000},{"t":1704902400000,"o":39.40,"h":39.80,"l":39.30,"c":39.70,"v":3000000},{"t":1704906000000,"o":39.70,"h":40.00,"l":39.60,"c":39.90,"v":2600000},{"t":1704909600000,"o":39.90,"h":40.20,"l":39.80,"c":40.10,"v":2400000},{"t":1704913200000,"o":40.10,"h":40.30,"l":40.00,"c":40.20,"v":2200000}],"sector_data":{"xlk_change":-1.5,"xlf_change":1.8,"spy_change":-0.3}}',
  '[{"type":"breakout","price":39.00,"strength":85,"label":"Breakout Level"},{"type":"vwap","price":39.20,"strength":75,"label":"VWAP"},{"type":"daily_resistance","price":40.00,"strength":80,"label":"Daily Resistance"}]',
  '{"price":39.70,"time":1704902400000,"context":"XLF breaking out while XLK sells off - sector rotation in play"}',
  'long',
  '{"result":"win","exit_price":40.50,"pnl_percent":2.02,"candles_to_target":8}',
  '{"level":{"score":85,"reason":"Clean breakout above $39 resistance with volume"},"trend":{"score":90,"reason":"Strong relative strength vs tech, sector rotation confirmed"},"patience":{"score":75,"reason":"Waited for breakout confirmation, not anticipating"}}',
  'Sector rotation offers opportunities when money flows from one sector to another. When tech (XLK) is weak and financials (XLF) are strong, its a clear rotation signal. The key is trading the sector showing strength, not trying to bottom-fish the weak sector. XLF breaking out while XLK sold off was a textbook rotation play.',
  ARRAY['sector', 'rotation', 'relative_strength', 'advanced', 'intermarket'],
  'trend',
  'sector_analysis',
  'seed',
  'ltp-framework/sector-rotation',
  true
),
(
  'Options Expiration Pin - QQQ',
  'Its monthly options expiration. QQQ gravitating toward max pain. How do you trade this?',
  'QQQ',
  'opex_dynamics',
  'advanced',
  '5m',
  '{"candles":[{"t":1704898800000,"o":388.50,"h":389.00,"l":388.00,"c":388.70,"v":3000000},{"t":1704899100000,"o":388.70,"h":389.50,"l":388.50,"c":389.20,"v":2800000},{"t":1704899400000,"o":389.20,"h":389.80,"l":388.80,"c":389.00,"v":2600000},{"t":1704899700000,"o":389.00,"h":389.50,"l":388.50,"c":388.80,"v":2500000},{"t":1704900000000,"o":388.80,"h":389.20,"l":388.30,"c":388.50,"v":2400000},{"t":1704900300000,"o":388.50,"h":389.00,"l":388.20,"c":388.80,"v":2300000},{"t":1704900600000,"o":388.80,"h":389.30,"l":388.60,"c":389.10,"v":2200000},{"t":1704900900000,"o":389.10,"h":389.50,"l":388.90,"c":389.00,"v":2100000}],"options_data":{"max_pain":389.00,"major_call_wall":390.00,"major_put_wall":388.00}}',
  '[{"type":"max_pain","price":389.00,"strength":90,"label":"Max Pain / Pin Level"},{"type":"call_wall","price":390.00,"strength":85,"label":"Call Wall Resistance"},{"type":"put_wall","price":388.00,"strength":85,"label":"Put Wall Support"}]',
  '{"price":388.50,"time":1704900000000,"context":"OPEX Friday, price oscillating around $389 max pain level"}',
  'wait',
  '{"result":"correct_wait","note":"Price stayed range-bound $388-390 all day, any directional trade would have chopped out"}',
  '{"level":{"score":90,"reason":"Max pain at $389, call wall at $390, put wall at $388 - pinned"},"trend":{"score":40,"reason":"No trend on OPEX, gamma pinning causing chop"},"patience":{"score":30,"reason":"OPEX chop is not a setup, its a trap"}}',
  'Monthly options expiration (OPEX) often sees pinning action where market makers hedge drives price toward max pain. The result is choppy, range-bound action that stops out directional traders. On OPEX, reduce position sizes or wait for the final hour when pins release.',
  ARRAY['opex', 'options', 'pin', 'advanced', 'max_pain'],
  'patience',
  'options_dynamics',
  'seed',
  'ltp-framework/options-dynamics',
  true
);

-- Add more scenarios for comprehensive coverage
INSERT INTO practice_scenarios (
  title, description, symbol, scenario_type, difficulty, chart_timeframe,
  chart_data, key_levels, decision_point, correct_action, outcome_data,
  ltp_analysis, explanation, tags, focus_area, category, source_type,
  related_lesson_slug, is_active
) VALUES
(
  'Pre-Market Level Test - AAPL',
  'AAPL testing pre-market high at market open. Level respect or break?',
  'AAPL',
  'premarket_level',
  'intermediate',
  '1m',
  '{"candles":[{"t":1704898800000,"o":186.50,"h":187.00,"l":186.30,"c":186.80,"v":500000},{"t":1704898860000,"o":186.80,"h":187.20,"l":186.70,"c":187.10,"v":450000},{"t":1704898920000,"o":187.10,"h":187.50,"l":187.00,"c":187.40,"v":480000},{"t":1704898980000,"o":187.40,"h":187.80,"l":187.30,"c":187.70,"v":520000},{"t":1704899040000,"o":187.70,"h":187.90,"l":187.40,"c":187.50,"v":550000},{"t":1704899100000,"o":187.50,"h":187.60,"l":187.20,"c":187.30,"v":500000}],"premarket":{"high":187.80,"low":186.00}}',
  '[{"type":"premarket_high","price":187.80,"strength":85,"label":"Pre-Market High"},{"type":"vwap","price":186.90,"strength":75,"label":"VWAP"},{"type":"open","price":186.50,"strength":70,"label":"Open Price"}]',
  '{"price":187.70,"time":1704898980000,"context":"Approaching pre-market high with slowing momentum"}',
  'wait',
  '{"result":"correct_wait","note":"Price rejected at PM high, pulled back to VWAP before continuing higher"}',
  '{"level":{"score":85,"reason":"Pre-market high is a key level that often sees reaction"},"trend":{"score":70,"reason":"Bullish but approaching resistance"},"patience":{"score":60,"reason":"Need to see level reaction before entering"}}',
  'Pre-market levels are significant. The PM high at $187.80 often acts as resistance on the first test. Instead of chasing into resistance, wait for: 1) A clean break and retest, or 2) A rejection to buy lower. Here, waiting avoided a whipsaw.',
  ARRAY['premarket', 'pmh', 'open', 'intermediate', 'level'],
  'level',
  'premarket_levels',
  'seed',
  'ltp-framework/premarket-levels',
  true
),
(
  'Volume Divergence Warning - INTC',
  'INTC rallying but on declining volume. Is this a warning sign?',
  'INTC',
  'volume_analysis',
  'intermediate',
  '5m',
  '{"candles":[{"t":1704898800000,"o":45.00,"h":45.50,"l":44.80,"c":45.40,"v":2000000},{"t":1704899100000,"o":45.40,"h":46.00,"l":45.30,"c":45.90,"v":1800000},{"t":1704899400000,"o":45.90,"h":46.50,"l":45.80,"c":46.40,"v":1500000},{"t":1704899700000,"o":46.40,"h":46.80,"l":46.30,"c":46.70,"v":1200000},{"t":1704900000000,"o":46.70,"h":47.00,"l":46.50,"c":46.80,"v":1000000},{"t":1704900300000,"o":46.80,"h":47.10,"l":46.60,"c":46.70,"v":800000}],"volume_analysis":{"trend":"declining","warning":"volume_divergence"}}',
  '[{"type":"resistance","price":47.00,"strength":70,"label":"Intraday Resistance"},{"type":"vwap","price":46.00,"strength":75,"label":"VWAP"},{"type":"volume_poc","price":45.50,"strength":80,"label":"Volume POC"}]',
  '{"price":46.80,"time":1704900000000,"context":"Price making higher highs but volume making lower highs"}',
  'wait',
  '{"result":"correct_wait","note":"Price reversed from $47 back to $45.50 volume POC"}',
  '{"level":{"score":70,"reason":"Approaching resistance with no clear support"},"trend":{"score":60,"reason":"Uptrend but volume divergence is warning"},"patience":{"score":50,"reason":"Volume divergence requires caution"}}',
  'Volume confirms price action. When price rises on declining volume, it suggests weakening buying pressure and potential reversal. This volume divergence warned of the coming pullback. Wait for volume to confirm before entering long into extended moves.',
  ARRAY['volume', 'divergence', 'warning', 'intermediate', 'confirmation'],
  'trend',
  'volume_analysis',
  'seed',
  'ltp-framework/volume-analysis',
  true
),
(
  'The Chop Zone - IWM',
  'IWM stuck between support and resistance. How do you navigate this?',
  'IWM',
  'range_trading',
  'advanced',
  '5m',
  '{"candles":[{"t":1704898800000,"o":200.50,"h":201.00,"l":200.00,"c":200.80,"v":1500000},{"t":1704899100000,"o":200.80,"h":201.20,"l":200.50,"c":200.60,"v":1400000},{"t":1704899400000,"o":200.60,"h":201.00,"l":200.20,"c":200.90,"v":1450000},{"t":1704899700000,"o":200.90,"h":201.30,"l":200.70,"c":200.80,"v":1380000},{"t":1704900000000,"o":200.80,"h":201.10,"l":200.40,"c":200.50,"v":1420000},{"t":1704900300000,"o":200.50,"h":200.90,"l":200.30,"c":200.70,"v":1350000}],"range":{"high":201.30,"low":200.00,"midpoint":200.65}}',
  '[{"type":"range_high","price":201.30,"strength":75,"label":"Range High"},{"type":"range_low","price":200.00,"strength":75,"label":"Range Low"},{"type":"vwap","price":200.60,"strength":70,"label":"VWAP (Middle of Range)"}]',
  '{"price":200.70,"time":1704900300000,"context":"Stuck in $1.30 range for hours, no clear direction"}',
  'wait',
  '{"result":"correct_wait","note":"Range continued for 2 more hours before breaking higher"}',
  '{"level":{"score":50,"reason":"In the middle of range - no edge either direction"},"trend":{"score":40,"reason":"No trend, just rotation within range"},"patience":{"score":30,"reason":"Trading middle of range is low probability"}}',
  'Range-bound markets require different tactics. The middle of a range is the worst place to enter - no edge either direction. Either: 1) Fade extremes (sell range high, buy range low), or 2) Wait for a breakout with volume confirmation. Trading the middle is gambling.',
  ARRAY['range', 'chop', 'patience', 'advanced', 'consolidation'],
  'patience',
  'range_strategies',
  'seed',
  'ltp-framework/range-trading',
  true
),
(
  'Earnings Gap and Go - TTD',
  'TTD gapped up 10% on earnings and continuing higher. Valid chase or wait for pullback?',
  'TTD',
  'earnings',
  'advanced',
  '5m',
  '{"candles":[{"t":1704898800000,"o":85.00,"h":86.50,"l":84.50,"c":86.20,"v":3000000},{"t":1704899100000,"o":86.20,"h":87.50,"l":86.00,"c":87.30,"v":2800000},{"t":1704899400000,"o":87.30,"h":88.50,"l":87.10,"c":88.20,"v":2600000},{"t":1704899700000,"o":88.20,"h":89.00,"l":88.00,"c":88.70,"v":2400000},{"t":1704900000000,"o":88.70,"h":89.50,"l":88.50,"c":89.30,"v":2200000},{"t":1704900300000,"o":89.30,"h":89.80,"l":89.00,"c":89.50,"v":2000000}],"earnings":{"eps_surprise":15,"revenue_beat":true,"guidance":"raised"}}',
  '[{"type":"gap_open","price":85.00,"strength":80,"label":"Gap Open"},{"type":"vwap","price":87.50,"strength":75,"label":"VWAP"},{"type":"round_number","price":90.00,"strength":70,"label":"$90 Psychological"}]',
  '{"price":89.50,"time":1704900300000,"context":"Strong earnings gap up with continuation, approaching $90"}',
  'long',
  '{"result":"win","exit_price":92.00,"pnl_percent":2.79,"candles_to_target":8}',
  '{"level":{"score":70,"reason":"VWAP acting as support on pullbacks"},"trend":{"score":90,"reason":"Strong gap up with continuation - gap and go pattern"},"patience":{"score":75,"reason":"Waiting for micro pullback to VWAP for entry"}}',
  'Gap and go setups after strong earnings can work if: 1) The beat is significant (15%+ EPS surprise), 2) Volume is massive, 3) Price is holding above VWAP. This is not a "chase" if you wait for a pullback to VWAP. Entry on the first VWAP test with stop below.',
  ARRAY['earnings', 'gap_and_go', 'momentum', 'advanced', 'catalyst'],
  'trend',
  'earnings_plays',
  'seed',
  'ltp-framework/earnings-trading',
  true
);

-- Update community stats to realistic values
UPDATE practice_scenarios SET
  community_attempts = floor(random() * 500 + 50)::int,
  community_accuracy = (random() * 30 + 55)::decimal(5,2)
WHERE source_type = 'seed';

-- Create some achievement-related scenarios
INSERT INTO practice_scenarios (
  title, description, symbol, scenario_type, difficulty, chart_timeframe,
  chart_data, key_levels, decision_point, correct_action, outcome_data,
  ltp_analysis, explanation, tags, focus_area, category, source_type,
  related_lesson_slug, is_active
) VALUES
(
  'Perfect LTP Setup - MSFT',
  'All three LTP components align perfectly. Can you recognize this textbook setup?',
  'MSFT',
  'perfect_setup',
  'beginner',
  '5m',
  '{"candles":[{"t":1704898800000,"o":378.00,"h":378.50,"l":377.50,"c":378.20,"v":200000},{"t":1704899100000,"o":378.20,"h":378.80,"l":377.80,"c":377.90,"v":220000},{"t":1704899400000,"o":377.90,"h":378.20,"l":377.50,"c":377.60,"v":240000},{"t":1704899700000,"o":377.60,"h":377.80,"l":377.20,"c":377.30,"v":260000},{"t":1704900000000,"o":377.30,"h":377.60,"l":377.00,"c":377.10,"v":250000},{"t":1704900300000,"o":377.10,"h":377.30,"l":376.90,"c":377.00,"v":230000},{"t":1704900600000,"o":377.00,"h":377.20,"l":376.80,"c":377.05,"v":210000},{"t":1704900900000,"o":377.05,"h":377.50,"l":377.00,"c":377.40,"v":200000}],"perfect_ltp":true}',
  '[{"type":"support","price":377.00,"strength":95,"label":"Key Support - Daily Level"},{"type":"vwap","price":377.50,"strength":85,"label":"VWAP"},{"type":"ema","price":377.20,"strength":80,"label":"21 EMA"}]',
  '{"price":377.05,"time":1704900600000,"context":"Level (daily support), Trend (above daily VWAP), Patience (4 candles at level)"}',
  'long',
  '{"result":"win","exit_price":380.50,"pnl_percent":0.91,"candles_to_target":8}',
  '{"level":{"score":95,"reason":"Daily support at $377 with multiple prior touches"},"trend":{"score":90,"reason":"Above VWAP on daily timeframe, bullish context"},"patience":{"score":90,"reason":"4 candles of consolidation showing absorption"}}',
  'This is what a perfect LTP setup looks like: Level (95) - Clear daily support at $377. Trend (90) - Above VWAP with bullish daily context. Patience (90) - 4 candles of consolidation at the level. When all three components score 85+, you have a high-probability setup.',
  ARRAY['ltp', 'perfect', 'textbook', 'beginner', 'high_probability'],
  'level',
  'ltp_perfect',
  'seed',
  'ltp-framework/complete-framework',
  true
),
(
  'Overtrading Trap - Multiple Symbols',
  'Youve taken 5 trades today, all small losses. Another setup appears. What do you do?',
  'SPY',
  'psychology',
  'advanced',
  '5m',
  '{"candles":[{"t":1704898800000,"o":472.00,"h":472.50,"l":471.50,"c":472.20,"v":1000000},{"t":1704899100000,"o":472.20,"h":472.80,"l":472.00,"c":472.60,"v":950000},{"t":1704899400000,"o":472.60,"h":473.00,"l":472.40,"c":472.50,"v":900000},{"t":1704899700000,"o":472.50,"h":472.80,"l":472.20,"c":472.70,"v":880000},{"t":1704900000000,"o":472.70,"h":473.20,"l":472.50,"c":473.00,"v":920000}],"trade_history":{"trades_today":5,"win_rate_today":0,"pnl_today":-250}}',
  '[{"type":"support","price":472.00,"strength":75,"label":"Intraday Support"},{"type":"vwap","price":472.30,"strength":70,"label":"VWAP"}]',
  '{"price":472.70,"time":1704899700000,"context":"5 losing trades today, another mediocre setup appearing"}',
  'wait',
  '{"result":"correct_wait","note":"Stepping away after 5 losses prevented further damage"}',
  '{"level":{"score":75,"reason":"Decent level but not great"},"trend":{"score":65,"reason":"Choppy, no clear direction"},"patience":{"score":40,"reason":"Trading to recover losses, not because setup is good"}}',
  'After 5 consecutive losses, the correct action is to stop trading for the day. The psychological state is compromised, leading to poor decision-making. This setup scores only 60% - not worth the risk in a compromised mental state. Live to trade another day.',
  ARRAY['overtrading', 'psychology', 'discipline', 'advanced', 'stop_trading'],
  'patience',
  'psychology',
  'seed',
  'ltp-framework/trading-psychology',
  true
);

-- Refresh the materialized view if it exists
-- REFRESH MATERIALIZED VIEW IF EXISTS practice_scenario_stats;

SELECT 'Practice scenarios seeded successfully. Total scenarios: ' || COUNT(*) as result
FROM practice_scenarios WHERE source_type = 'seed';
